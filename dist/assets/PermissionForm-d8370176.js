import{b as q,d as O,cT as z,be as d,e9 as B,q as H,ea as M,eb as R,x as e,b$ as W,ap as D,ai as m,bW as l,bJ as c,L as h,bL as Q,bM as j,ao as J,S as b,bN as N,W as $,dl as f,dm as S,dn as U,aY as u,am as V,bQ as Y,bR as A,bS as E,av as k,bg as G,bT as K,Q as v,bw as x,n as P}from"./index-dc050277.js";const Z=()=>{const n=q(),{params:C,back:g}=O(),{id:i}=C,[s,o]=z({name:"",description:"",permission:0,path_pattern:"/**"}),[w,y]=d(()=>B(parseInt(i))),T=async()=>{if(i){const r=await y();x(r,t=>{o({name:t.name,description:t.description,permission:t.permission,path_pattern:t.path_pattern})})}};H(()=>{T()});const _=()=>s.name.trim()?!0:(P.error(n("permissions.config.permissions_name")+n("global.required")),!1),[I,L]=d(async()=>_()?i?M({...s,id:parseInt(i)}):R(s):Promise.reject()),a=()=>u.filter((r,t)=>(s.permission>>t&1)===1),p=r=>{const t=1<<r;o("permission",s.permission^t)};return e(m,{spacing:"$2",alignItems:"start",w:"$full",get children(){return[e(W,{get children(){return n(i?"global.edit":"global.add")}}),e(D,{get loading(){return w()},get children(){return e(m,{spacing:"$2",alignItems:"start",w:"$full",get children(){return[e(l,{required:!0,get children(){return[e(c,{get children(){return n("permissions.config.permissions_name")}}),e(h,{get value(){return s.name},onInput:r=>o("name",r.currentTarget.value)})]}}),e(l,{get children(){return[e(c,{get children(){return n("permissions.config.permissions_description")}}),e(h,{get value(){return s.description},onInput:r=>o("description",r.currentTarget.value)})]}}),e(l,{required:!0,get children(){return[e(c,{get children(){return n("permissions.config.permissions_permissions")}}),e(Q,{multiple:!0,get value(){return a()},get children(){return[e(j,{get children(){return e(J,{display:"flex",flexWrap:"wrap",gap:"$2",pr:"$6",py:"$2",minH:"40px",alignItems:"center",get children(){return e(b,{get when(){return a().length>0},get fallback(){return e(N,{get children(){return n("permissions.config.select_permissions")}})},get children(){return[e($,{get each(){return a().slice(0,3)},children:(r,t)=>e(f,{size:"lg",variant:"subtle",bgColor:"$neutral2",rounded:"$sm",px:"$3",py:"$1",get children(){return[e(S,{get children(){return n(`users.permissions.${r}`)}}),e(U,{onClick:F=>{F.stopPropagation(),p(u.indexOf(r))}})]}})}),e(b,{get when(){return a().length>3},get children(){return e(f,{size:"lg",variant:"subtle",bgColor:"$neutral2",rounded:"$sm",px:"$3",py:"$1",get children(){return e(S,{get children(){return["+",V(()=>a().length-3)]}})}})}})]}})}})}}),e(Y,{get children(){return e(A,{get children(){return e($,{each:u,children:(r,t)=>e(E,{value:r,onClick:()=>p(t()),get children(){return e(k,{spacing:"$2",w:"$full",pl:"$4",fontSize:"$lg",get children(){return[e(G,{get checked(){return(s.permission>>t()&1)===1},readOnly:!0}),e(K,{get children(){return n(`users.permissions.${r}`)}})]}})}})})}})}})]}})]}}),e(k,{spacing:"$2",get children(){return[e(v,{get loading(){return I()},onClick:async()=>{const r=await L();x(r,()=>{P.success(n("global.save_success")),g()})},get children(){return n("global.save")}}),e(v,{colorScheme:"accent",onClick:()=>g(),get children(){return n("global.back")}})]}})]}})}})]}})};export{Z as default};
