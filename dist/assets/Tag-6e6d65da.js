import{b as R,d as A,B as n,al as F,q as E,x as e,av as f,Q as o,S as p,ao as I,dB as N,dC as V,dD as b,W as m,dE as S,dF as W,dG as c,cV as q,da as z,bw as w,n as y,R as G,M as J,I as K,J as P,K as Q,O as X,ai as j,b1 as U,bv as C,dH as Y}from"./index-83beb5cc.js";import{g as Z}from"./color-a58de010.js";import{D as ee}from"./DeletePopover-d0b5bfce.js";import te from"./AddLabelDialog-8f6aed30.js";const se=()=>{const a=R(),{to:$}=A(),[L,u]=n(!1),[_,d]=n(!1),[k,i]=n(null),[g,M]=n(!1),[T,s]=n(!1),O=async()=>{var t;try{const r=await C.get("/fs/list");return r.code===500&&((t=r.message)!=null&&t.includes("please add a storage first"))?(s(!0),!1):!0}catch(r){return console.error("Failed to check storage:",r),!1}},[v,{refetch:B}]=F(async()=>g()?await U():{data:{content:[],total:0}}),D=async t=>await C.post(`/admin/label/delete?id=${t}`),l=async()=>{try{u(!0);const t=await O();M(t),t&&await B()}catch{y.error(a("global.refresh_failed"))}finally{u(!1)}};E(()=>{l()});const x=(t,r,h)=>{l()},H=async t=>{const r=await Y(t);w(r,h=>{i(h),d(!0)})};return e(j,{spacing:"$2",alignItems:"start",w:"$full",get children(){return[e(f,{spacing:"$2",get children(){return[e(o,{colorScheme:"accent",get loading(){return L()},onClick:l,get children(){return a("global.refresh")}}),e(p,{get when(){return g()},get children(){return e(o,{onClick:()=>{i(null),d(!0)},get children(){return a("global.add")}})}})]}}),e(p,{get when(){return g()},get children(){return e(I,{w:"$full",overflowX:"auto",get children(){return e(N,{highlightOnHover:!0,dense:!0,get children(){return[e(V,{get children(){return e(b,{get children(){return[e(m,{each:["name","description","create_time"],children:t=>e(S,{get children(){return a(`home.tag.${t}`)}})}),e(S,{get children(){return a("global.operations")}})]}})}}),e(W,{get children(){return e(m,{get each(){var t,r;return((r=(t=v())==null?void 0:t.data)==null?void 0:r.content)||[]},children:t=>e(b,{get children(){return[e(c,{get children(){return e(q,{get bgColor(){return Z(t.bg_color)},get color(){return t.bg_color},textTransform:"none",px:"$3",py:"$2",rounded:"$md",fontSize:"$sm",get children(){return t.name}})}}),e(c,{get children(){return t.description}}),e(c,{get children(){return z(t.create_time)}}),e(c,{get children(){return e(f,{spacing:"$2",get children(){return[e(o,{colorScheme:"accent",onClick:()=>H(t.id),get children(){return a("global.edit")}}),e(ee,{get name(){return t.name},loading:!1,onClick:async()=>{const r=await D(t.id);w(r,()=>{y.success(a("global.delete_success")),l()})}})]}})}})]}})})}})]}})}})}}),e(te,{get isOpen(){return _()},onClose:()=>{d(!1),i(null)},onSubmit:x,get editingLabel(){return k()}}),e(G,{get opened(){return T()},onClose:()=>s(!1),get children(){return[e(J,{}),e(K,{get children(){return[e(P,{}),e(Q,{get children(){return a("storages.no_storage_content")}}),e(X,{get children(){return[e(o,{colorScheme:"accent",onClick:()=>s(!1),get children(){return a("global.cancel")}}),e(o,{onClick:()=>{s(!1),$("/@manage/storages")},ml:"$2",get children(){return a("home.go_to_storages")}})]}})]}})]}})]}})};export{se as default};
