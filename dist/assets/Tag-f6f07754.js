import{b as R,d as F,B as n,al as H,q as E,x as e,av as f,Q as o,S as p,ao as I,dA as N,dB as W,dC as b,W as m,dD as S,dE as q,dF as c,cU as z,d9 as G,bw as w,n as y,R as J,M as K,I as P,J as Q,K as U,O as V,ai as X,b1 as j,bv as C,dG as Y}from"./index-dc050277.js";import{g as Z}from"./color-a58de010.js";import{D as ee}from"./DeletePopover-2254ac41.js";import te from"./AddLabelDialog-98574d11.js";const se=()=>{const a=R(),{to:$}=F(),[L,u]=n(!1),[_,d]=n(!1),[k,i]=n(null),[g,M]=n(!1),[T,s]=n(!1),O=async()=>{var t;try{const r=await C.get("/fs/list");return r.code===500&&((t=r.message)!=null&&t.includes("please add a storage first"))?(s(!0),!1):!0}catch(r){return console.error("Failed to check storage:",r),!1}},[v,{refetch:B}]=H(async()=>g()?await j():{data:{content:[],total:0}}),D=async t=>await C.post(`/admin/label/delete?id=${t}`),l=async()=>{try{u(!0);const t=await O();M(t),t&&await B()}catch{y.error(a("global.refresh_failed"))}finally{u(!1)}};E(()=>{l()});const x=(t,r,h)=>{l()},A=async t=>{const r=await Y(t);w(r,h=>{i(h),d(!0)})};return e(X,{spacing:"$2",alignItems:"start",w:"$full",get children(){return[e(f,{spacing:"$2",get children(){return[e(o,{colorScheme:"accent",get loading(){return L()},onClick:l,get children(){return a("global.refresh")}}),e(p,{get when(){return g()},get children(){return e(o,{onClick:()=>{i(null),d(!0)},get children(){return a("global.add")}})}})]}}),e(p,{get when(){return g()},get children(){return e(I,{w:"$full",overflowX:"auto",get children(){return e(N,{highlightOnHover:!0,dense:!0,get children(){return[e(W,{get children(){return e(b,{get children(){return[e(m,{each:["name","description","create_time"],children:t=>e(S,{get children(){return a(`home.tag.${t}`)}})}),e(S,{get children(){return a("global.operations")}})]}})}}),e(q,{get children(){return e(m,{get each(){var t,r;return((r=(t=v())==null?void 0:t.data)==null?void 0:r.content)||[]},children:t=>e(b,{get children(){return[e(c,{get children(){return e(z,{get bgColor(){return Z(t.bg_color)},get color(){return t.bg_color},textTransform:"none",px:"$3",py:"$2",rounded:"$md",fontSize:"$sm",get children(){return t.name}})}}),e(c,{get children(){return t.description}}),e(c,{get children(){return G(t.create_time)}}),e(c,{get children(){return e(f,{spacing:"$2",get children(){return[e(o,{colorScheme:"accent",onClick:()=>A(t.id),get children(){return a("global.edit")}}),e(ee,{get name(){return t.name},loading:!1,onClick:async()=>{const r=await D(t.id);w(r,()=>{y.success(a("global.delete_success")),l()})}})]}})}})]}})})}})]}})}})}}),e(te,{get isOpen(){return _()},onClose:()=>{d(!1),i(null)},onSubmit:x,get editingLabel(){return k()}}),e(J,{get opened(){return T()},onClose:()=>s(!1),get children(){return[e(K,{}),e(P,{get children(){return[e(Q,{}),e(U,{get children(){return a("storages.no_storage_content")}}),e(V,{get children(){return[e(o,{colorScheme:"accent",onClick:()=>s(!1),get children(){return a("global.cancel")}}),e(o,{onClick:()=>{s(!1),$("/@manage/storages")},ml:"$2",get children(){return a("home.go_to_storages")}})]}})]}})]}})]}})};export{se as default};
