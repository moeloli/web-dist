import{dM as U,U as v,d as F,x as t,ai as M,$ as C,am as g,av as f,eh as p,E as O,S as h,b2 as A,aP as V,aC as L,d8 as G,d0 as _,aO as B,ah as u,q as N,r as R,b0 as z,W as $,aZ as X,cV as W,ao as J,cW as T,da as Z,au as Q,az as E,A as Y,b as D,o as ee,ay as te,j as ne,e as re,B as P,H as ie,ei as ae,ej as oe,b5 as le,V as j,ek as se,ad as ce}from"./index-83beb5cc.js";import{b as de}from"./style-6214d24b.js";import{s as ue}from"./index-69e5e5d5.js";import{I as q,u as H}from"./helper-ad1ad2f8.js";import{g as I}from"./color-a58de010.js";const ge=E("<div></div>"),he=E("<style></style>"),a=[{name:"name",textAlign:"left",w:{"@initial":"calc(100% - 100px)","@md":"35%"}},{name:"size",textAlign:"right",w:{"@initial":"100px","@md":"30%"}},{name:"modified",textAlign:"right",w:{"@initial":0,"@md":"25%"}}],fe=()=>{const n=re,s=Y(()=>n().reduce((m,o)=>m+(o.size||0),0)),i=D();return t(h,{get when(){return n().length>0},get children(){return t(f,{spacing:"$2",position:"fixed",top:"$4",right:"$4",transform:"none",get bgColor(){return L()},color:"white",p:"$2",rounded:"$lg",zIndex:"$banner",shadow:"$md",get children(){return[t(u,{get children(){return[g(()=>i("home.selected"))," ",g(()=>n().length)," ",g(()=>i("home.selected_count"))]}}),t(u,{get children(){return[g(()=>i("home.total_size"))," ",g(()=>T(s()))]}})]}})}})},be=n=>{const{isHide:s}=U();if(v(),s(n.obj))return null;const{setPathAs:i}=v(),{show:m}=de({id:1}),{pushHref:o,to:l,pathname:c}=F(),{openWithDoubleClick:r,toggleWithClick:d,restoreSelectionCache:x}=H(),b=()=>ee.list_item_filename_overflow,S=()=>(te().permissions,ne(c(),n.obj.name));return[t(Q.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.2},style:{width:"100%"},get children(){return t(M,{get classList(){return{selected:!!n.obj.selected}},class:"list-item viselect-item",get"data-index"(){return n.index},w:"$full",p:"$2",rounded:"$lg",transition:"all 0.3s",spacing:"$1",alignItems:"stretch",get _hover(){return{transform:"scale(1.01)",backgroundColor:C()}},get bgColor(){return g(()=>!!n.obj.selected,!0)()?C():void 0},get children(){return[t(f,{w:"$full",spacing:"$2",get children(){return[t(f,{class:"name-box",spacing:"$1",get w(){return a[0].w},as:ue,get href(){return n.obj.name},get cursor(){return r()||d()?"default":"pointer"},"on:dblclick":()=>{r()&&(p(n.index,!0,!0),l(S()))},"on:click":e=>{if(e.preventDefault(),!r()&&!(e.ctrlKey||e.metaKey||e.shiftKey)&&x()){if(d())return p(n.index,!n.obj.selected);l(S())}},onMouseEnter:()=>{i(n.obj.name,n.obj.is_dir,!0)},onContextMenu:e=>{O(()=>{p(n.index,!0,!0)}),m(e,{props:n.obj})},get children(){return[t(h,{get when(){return A()},get children(){return t(q,{"on:mousedown":e=>{e.stopPropagation()},"on:click":e=>{e.stopPropagation()},get checked(){return n.obj.selected},onChange:e=>{p(n.index,e.target.checked)}})}}),t(V,{class:"icon",boxSize:"$6",get color(){return L()},get as(){return G(n.obj)},mr:"$1",get cursor(){return n.obj.type!==_.IMAGE?"inherit":"pointer"},"on:click":e=>{n.obj.type===_.IMAGE&&(e.ctrlKey||e.metaKey||e.shiftKey||x()&&(B.emit("gallery",n.obj.name),e.preventDefault(),e.stopPropagation()))}}),t(u,{class:"name",fontSize:{"@initial":"sm","@md":"md"},get css(){return{position:"relative",flex:1,minWidth:0,cursor:"pointer",...b()==="ellipsis"&&{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},...b()==="scrollable"&&{whiteSpace:"nowrap",overflow:"hidden"},...b()==="multi_line"&&{whiteSpace:"normal",wordBreak:"break-word",lineHeight:"1.4"}}},get title(){return n.obj.name},get children(){return[t(h,{get when(){return b()==="scrollable"},get children(){return[(()=>{const e=ge.cloneNode(!0);return(w=>{w&&N(()=>{const y=()=>{const k=w.parentElement;k&&w.scrollWidth>k.clientWidth?w.classList.add("should-marquee"):w.classList.remove("should-marquee")};y(),window.addEventListener("resize",y),R(()=>{window.removeEventListener("resize",y)})})})(e),e.style.setProperty("display","inline-block"),e.style.setProperty("white-space","nowrap"),e.style.setProperty("padding-right","50px"),z(e,()=>n.obj.name),e})(),(()=>{const e=he.cloneNode(!0);return z(e,()=>`
                    .should-marquee:hover {
                      animation: marquee 8s linear infinite;
                    }
                    @keyframes marquee {
                      0% { transform: translateX(0); }
                      100% { transform: translateX(calc(-100% + ${a[0].w["@initial"]})); }
                    }
                    `),e})()]}}),t(h,{get when(){return b()!=="scrollable"},get children(){return n.obj.name}})]}})]}}),t(f,{spacing:"$0_5",justifyContent:"flex-start",overflow:"hidden",w:"25%",minW:"200px",display:{"@initial":"none","@md":"flex"},get children(){return t(h,{get when(){var e;return(e=n.obj.label_list)==null?void 0:e.length},get children(){return t($,{get each(){return n.obj.label_list||[]},children:e=>t(X,{get label(){return e.name},placement:"top",get children(){return t(W,{colorScheme:"primary",get bgColor(){return I(e.bg_color)},get color(){return e.bg_color},variant:"solid",mr:"$0_5",textTransform:"none",maxW:"120px",overflow:"hidden",css:{textOverflow:"ellipsis",whiteSpace:"nowrap",fontSize:"0.75rem",paddingInline:"0.5rem",paddingBlock:"0.25rem"},get children(){return e.name}})}})})}})}}),t(J,{w:{"@initial":"90px","@md":"12%"},minW:{"@initial":"90px","@md":"12%"},display:"flex",justifyContent:{"@initial":"flex-end","@md":"flex-start"},flexShrink:0,pr:{"@initial":"0","@md":"$2"},get children(){return t(u,{class:"size",fontSize:{"@initial":"sm","@md":"md"},css:{whiteSpace:"nowrap"},get children(){return T(n.obj.size)}})}}),t(u,{class:"modified",display:{"@initial":"none","@md":"inline"},w:"20%",minW:"20%",textAlign:"right",css:{whiteSpace:"nowrap"},get children(){return Z(n.obj.modified)}})]}}),t(h,{get when(){var e;return(e=n.obj.label_list)==null?void 0:e.length},get children(){return t(f,{spacing:"$1",flexWrap:"wrap",pl:"$8",display:{"@initial":"flex","@md":"none"},w:"$full",get children(){return t($,{get each(){return n.obj.label_list||[]},children:e=>t(W,{colorScheme:"primary",get bgColor(){return I(e.bg_color)},get color(){return e.bg_color},variant:"solid",textTransform:"none",css:{fontSize:"0.65rem",paddingInline:"0.3rem",paddingBlock:"0.1rem",whiteSpace:"nowrap",lineHeight:"1.2"},get children(){return e.name}})})}})}})]}})}}),t(fe,{})]},K=n=>{const s=D(),[i,m]=P(),[o,l]=P(!1);ie(()=>{i()&&n.sortCallback(i(),o())});const c=r=>({fontWeight:"bold",fontSize:"$sm",color:"$neutral11",textAlign:r.textAlign,cursor:"pointer",onClick:()=>{r.name===i()?l(!o()):O(()=>{m(r.name),l(!1)})}});return t(f,{class:"title",w:"$full",p:"$2",get children(){return[t(f,{get w(){return a[0].w},spacing:"$1",get children(){return[t(h,{get when(){return g(()=>!n.disableCheckbox,!0)()&&A()},get children(){return t(q,{get checked(){return ae()},get indeterminate(){return oe()},onChange:r=>{le(r.target.checked)}})}}),t(u,j(()=>c(a[0]),{get children(){return s(`home.obj.${a[0].name}`)}}))]}}),t(u,j({get w(){return a[1].w}},()=>c(a[1]),{get children(){return s(`home.obj.${a[1].name}`)}})),t(u,j({get w(){return a[2].w}},()=>c(a[2]),{display:{"@initial":"none","@md":"inline"},get children(){return s(`home.obj.${a[2].name}`)}}))]}})},we=()=>{const n=o=>{var r;const l=UserPermissions.findIndex(d=>d==="write");if(!UserMethods.can(me(),l,getCurrentPath()))return;const c=Array.from(((r=o.dataTransfer)==null?void 0:r.items)??[]);for(let d=0;d<c.length;d++)if(c[d].kind==="file"){B.emit("tool","upload"),o.preventDefault();break}},{isMouseSupported:s,registerSelectContainer:i,captureContentMenu:m}=H();return i(),t(M,{onDragOver:n,"oncapture:contextmenu":m,class:"list viselect-container",w:"$full",spacing:"$1",get children(){return[t(K,{sortCallback:se}),t($,{get each(){return ce.objs},children:(o,l)=>t(be,{obj:o,get index(){return l()}})})]}})},Se=Object.freeze(Object.defineProperty({__proto__:null,ListTitle:K,default:we},Symbol.toStringTag,{value:"Module"}));export{K as L,Se as a,a as c};
