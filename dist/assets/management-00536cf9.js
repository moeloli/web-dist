import{b as T,d as x,B as i,q as B,x as t,av as h,Q as K,am as o,ao as y,dB as E,dC as L,dD as _,W as l,dE as O,dF as R,dG as U,ai as A,n as a,cp as F,e4 as H,bw as f,e5 as I}from"./index-83beb5cc.js";import{D as M}from"./DeletePopover-d0b5bfce.js";import{g as p}from"./ua-parser-5a8f43f2.js";const z=()=>{const r=T(),{to:m}=x(),[v,S]=i([]),[$,u]=i(!1),[g,s]=i(null),[d,k]=i(null),w=async e=>{k(e);try{const n=await I(e);f(n,()=>{a.success(r("session.kick_out_success")),c()},b=>{a.error(b||r("session.kick_out_failed"))})}catch{a.error(r("session.kick_out_failed"))}finally{k(null)}},C=e=>{const n=localStorage.getItem("device_key");return n&&e.session_id===n},D=async e=>{C(e)?(a.error(r("session.kick_out_current_session")),F(),m(`/@login?redirect=${encodeURIComponent(window.location.pathname)}`)):await w(e.session_id)},c=async()=>{u(!0),s(null);try{const e=await H();f(e,n=>{S(n||[])},n=>{s(n)})}catch(e){s(e instanceof Error?e.message:"Unknown error")}finally{u(!1)}};return B(()=>{c()}),t(A,{spacing:"$2",alignItems:"start",w:"$full",get children(){return[t(h,{spacing:"$2",get children(){return t(K,{colorScheme:"accent",get loading(){return $()},onClick:c,get children(){return r("global.refresh")}})}}),o(()=>o(()=>!!g(),!0)()&&t(y,{color:"red.500",fontSize:"sm",get children(){return g()}})),t(y,{w:"$full",overflowX:"auto",get children(){return t(E,{highlightOnHover:!0,dense:!0,get children(){return[t(L,{get children(){return t(_,{get children(){return t(l,{each:[{key:"device_id",align:"left"},{key:"system_info",align:"left"},{key:"ip",align:"center"},{key:"last_active",align:"center"},{key:"status",align:"center"},{key:"user_id",align:"center"},{key:"operations",align:"center"}],children:e=>t(O,{get textAlign(){return e.align},get children(){return o(()=>e.key==="operations",!0)()?r("global.operations"):r(`session.${e.key}`)}})})}})}}),t(R,{get children(){return t(l,{get each(){return v()},children:e=>t(_,{get children(){return t(l,{get each(){return[{key:"device_id",align:"left",content:e.session_id?`${e.session_id.slice(0,6)}***${e.session_id.slice(-6)}`:"-"},{key:"system_info",align:"left",content:e.ua?p(e.ua):"-"},{key:"ip",align:"center",content:e.ip||"-"},{key:"last_active",align:"center",content:e.last_active?new Date(e.last_active*1e3).toLocaleString():"-"},{key:"status",align:"center",content:e.status===0?r("session.active"):r("session.offline")},{key:"user_id",align:"center",content:e.user_id},{key:"operations",align:"center",content:t(h,{spacing:"$2",justifyContent:"center",get children(){return t(M,{get name(){return`${e.session_id?`${e.session_id.slice(0,6)}***${e.session_id.slice(-6)}`:"-"} (${e.ua?p(e.ua):"-"})`},get loading(){return d()===e.session_id},get disabled(){return d()!==null},onClick:()=>D(e),get buttonText(){return r("session.kick_out")}})}})}]},children:n=>t(U,{get textAlign(){return n.align},get children(){return n.content}})})}})})}})]}})}})]}})};export{z as default};
