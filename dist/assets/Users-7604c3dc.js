import{b as R,d as v,be as B,bv as h,B as T,e0 as b,x as e,av as m,Q as l,ao as S,dA as U,dB as F,dC as $,W as f,dD as w,dE as x,dF as o,bw as i,n as C,ai as D,cU as L,d_ as W}from"./index-dc050277.js";import{b as H}from"./useTitle-6998e8fe.js";import{D as I}from"./DeletePopover-2254ac41.js";import{W as A}from"./Wether-9f03593b.js";const E=t=>{const[c,d]=T([]);(async()=>{const s=await W();i(s,n=>{d(n.content)})})();const u=s=>{switch(s){case 1:return"neutral";case 2:return"success";default:return"info"}};return e(m,{spacing:"$1",get children(){return e(f,{get each(){return t.role},children:s=>e(L,{get colorScheme(){return u(s)},get children(){var n;return(n=c().find(g=>g.id===s))==null?void 0:n.name}})})}})},V=()=>{const t=R();H("manage.sidemenu.users");const{to:c}=v(),[d,p]=B(()=>h.get("/admin/user/list")),[u,s]=T([]),n=async()=>{const r=await p();i(r,a=>s(a.content))};n();const[g,_]=b(r=>h.post(`/admin/user/delete?id=${r}`)),[k,y]=b(r=>h.post(`/admin/user/cancel_2fa?id=${r}`));return e(D,{spacing:"$2",alignItems:"start",w:"$full",get children(){return[e(m,{spacing:"$2",get children(){return[e(l,{colorScheme:"accent",get loading(){return d()},onClick:n,get children(){return t("global.refresh")}}),e(l,{onClick:()=>{c("/@manage/users/add")},get children(){return t("global.add")}})]}}),e(S,{w:"$full",overflowX:"auto",get children(){return e(U,{highlightOnHover:!0,dense:!0,get children(){return[e(F,{get children(){return e($,{get children(){return[e(f,{each:["username","role","available"],children:r=>e(w,{get children(){return t(`users.${r}`)}})}),e(w,{get children(){return t("global.operations")}})]}})}}),e(x,{get children(){return e(f,{get each(){return u()},children:r=>e($,{get children(){return[e(o,{get children(){return r.username}}),e(o,{get children(){return e(E,{get role(){return r.role}})}}),e(o,{get children(){return e(A,{get yes(){return!r.disabled}})}}),e(o,{get children(){return e(m,{spacing:"$2",get children(){return[e(l,{onClick:()=>{c(`/@manage/users/edit/${r.id}`)},get children(){return t("global.edit")}}),e(I,{get name(){return r.username},get loading(){return g()===r.id},onClick:async()=>{const a=await _(r.id);i(a,()=>{C.success(t("global.delete_success")),n()})}}),e(l,{colorScheme:"accent",get loading(){return k()===r.id},onClick:async()=>{const a=await y(r.id);i(a,()=>{C.success(t("users.cancel_2fa_success")),n()})},get children(){return t("users.cancel_2fa")}})]}})}})]}})})}})]}})}})]}})};export{V as default};
