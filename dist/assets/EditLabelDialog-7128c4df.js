import{b as O,d as T,U as M,B as d,H as j,x as e,M as v,I as z,bz as I,J as P,K as F,ai as H,bW as _,bJ as p,bL as N,bM as R,ao as W,S as u,bN as q,W as h,dm as b,dn as m,dp as E,am as J,bQ as Q,bS as D,av as i,bg as K,bT as U,O as V,Q as o,aP as A,dq as G,R as X,b6 as Y,bw as Z,n as f}from"./index-83beb5cc.js";const te=n=>{const l=O(),{to:S}=T(),{refresh:C}=M(),[a,s]=d([]),[$,g]=d(!1),y=()=>{var t;n.isOpen&&((t=n.obj.label_list)!=null&&t.length)?s(n.obj.label_list.map(r=>r.id.toString())):s([])};j(()=>{n.isOpen&&y()});const w=async()=>{try{g(!0);const t=n.isBatch&&n.selectedObjs?n.selectedObjs:[n.obj],r=await Y(a(),t);Z(r,()=>{f.success(l("home.tag.bind_success")),n.onSubmit(a()),n.onClose(),setTimeout(()=>{C(!1,!1)},300)})}catch(t){f.error(t.message||l("home.tag.bind_failed"))}finally{g(!1)}},x=()=>{n.onClose(),S("/@manage/settings/tag")},B=t=>{const r=a();r.includes(t)?s(r.filter(c=>c!==t)):s([...r,t])},L=t=>{s(a().filter(r=>r!==t))},k=t=>{var r;return((r=n.labels.find(c=>c.id.toString()===t))==null?void 0:r.name)||""};return e(X,{get opened(){return n.isOpen},get onClose(){return n.onClose},get children(){return[e(v,{}),e(z,{get children(){return[e(I,{}),e(P,{get children(){return l("home.tag.tag")}}),e(F,{get children(){return e(H,{spacing:"$3",get children(){return e(_,{required:!0,get children(){return[e(p,{color:"$neutral11",get children(){return l("home.tag.select")}}),e(N,{multiple:!0,get value(){return a()},onChange:s,get children(){return[e(R,{get children(){return e(W,{display:"flex",flexWrap:"wrap",gap:"$2",p:"$2",minH:"40px",alignItems:"center",get children(){return e(u,{get when(){return a().length>0},get fallback(){return e(q,{get children(){return l("home.tag.select")}})},get children(){return[e(h,{get each(){return a().slice(0,3)},children:t=>e(b,{size:"lg",variant:"subtle",bgColor:"$neutral2",rounded:"$sm",px:"$3",py:"$1",get children(){return[e(m,{get children(){return k(t)}}),e(E,{onClick:r=>{r.stopPropagation(),L(t)}})]}})}),e(u,{get when(){return a().length>3},get children(){return e(b,{size:"lg",variant:"subtle",bgColor:"$neutral2",rounded:"$sm",px:"$3",py:"$1",get children(){return e(m,{get children(){return["+",J(()=>a().length-3)]}})}})}})]}})}})}}),e(Q,{get children(){return e(h,{get each(){return n.labels},children:t=>e(D,{get value(){return t.id.toString()},onClick:()=>B(t.id.toString()),get children(){return e(i,{spacing:"$2",w:"$full",pl:"$4",fontSize:"$lg",get children(){return[e(K,{get checked(){return a().includes(t.id.toString())},readOnly:!0}),e(U,{get children(){return t.name}})]}})}})})}})]}})]}})}})}}),e(V,{get children(){return e(i,{spacing:"$2",justifyContent:"space-between",w:"$full",get children(){return[e(o,{onClick:x,get leftIcon(){return e(A,{as:G,boxSize:"$5"})},get children(){return l("home.tag.new")}}),e(i,{spacing:"$2",get children(){return[e(o,{colorScheme:"primary",get onClick(){return n.onClose},get children(){return l("global.cancel")}}),e(o,{onClick:w,get loading(){return $()},get children(){return l("global.confirm")}})]}})]}})}})]}})]}})};export{te as default};
