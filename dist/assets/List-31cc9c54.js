import{dL as H,U as k,d as U,x as n,ai as W,$ as v,am as m,av as h,ec as w,E as L,S as b,b2 as M,aP as F,aC as O,d7 as V,c$ as C,aO as A,ah as u,q as G,r as N,b0 as _,W as $,aZ as R,cU as z,ao as X,cV as T,d9 as J,au as Z,az as B,A as Q,b as E,ay as Y,j as ee,e as te,B as P,H as ne,ed as re,ee as ie,b5 as ae,V as y,ef as oe,ad as se}from"./index-dc050277.js";import{b as le}from"./style-c71c3fa8.js";import{q as ce}from"./index-9168b993.js";import{I as q,u as D}from"./helper-324a3754.js";import{g as I}from"./color-a58de010.js";const de=B("<div></div>"),ue=B("<style></style>"),a=[{name:"name",textAlign:"left",w:{"@initial":"calc(100% - 100px)","@md":"50%"}},{name:"size",textAlign:"right",w:{"@initial":"100px","@md":"12%"}},{name:"modified",textAlign:"right",w:{"@initial":0,"@md":"25%"}}],ge=()=>{const t=te,l=Q(()=>t().reduce((g,o)=>g+(o.size||0),0)),i=E();return n(b,{get when(){return t().length>0},get children(){return n(h,{spacing:"$2",position:"fixed",top:"$4",right:"$4",transform:"none",get bgColor(){return O()},color:"white",p:"$2",rounded:"$lg",zIndex:"$banner",shadow:"$md",get children(){return[n(u,{get children(){return[m(()=>i("home.selected"))," ",m(()=>t().length)," ",m(()=>i("home.selected_count"))]}}),n(u,{get children(){return[m(()=>i("home.total_size"))," ",m(()=>T(l()))]}})]}})}})},he=t=>{const{isHide:l}=H();if(k(),l(t.obj))return null;const{setPathAs:i}=k(),{show:g}=le({id:1}),{pushHref:o,to:s,pathname:c}=U(),{openWithDoubleClick:r,toggleWithClick:d,restoreSelectionCache:p}=D(),j=()=>(Y().permissions,ee(c(),t.obj.name));return[n(Z.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.2},style:{width:"100%"},get children(){return n(W,{get classList(){return{selected:!!t.obj.selected}},class:"list-item viselect-item",get"data-index"(){return t.index},w:"$full",p:"$2",rounded:"$lg",transition:"all 0.3s",spacing:"$1",alignItems:"stretch",get _hover(){return{transform:"scale(1.01)",backgroundColor:v()}},get bgColor(){return m(()=>!!t.obj.selected,!0)()?v():void 0},get children(){return[n(h,{w:"$full",spacing:"$2",get children(){return[n(h,{class:"name-box",spacing:"$1",get w(){return a[0].w},as:ce,get href(){return t.obj.name},get cursor(){return r()||d()?"default":"pointer"},"on:dblclick":()=>{r()&&(w(t.index,!0,!0),s(j()))},"on:click":e=>{if(e.preventDefault(),!r()&&!(e.ctrlKey||e.metaKey||e.shiftKey)&&p()){if(d())return w(t.index,!t.obj.selected);s(j())}},onMouseEnter:()=>{i(t.obj.name,t.obj.is_dir,!0)},onContextMenu:e=>{L(()=>{w(t.index,!0,!0)}),g(e,{props:t.obj})},get children(){return[n(b,{get when(){return M()},get children(){return n(q,{"on:mousedown":e=>{e.stopPropagation()},"on:click":e=>{e.stopPropagation()},get checked(){return t.obj.selected},onChange:e=>{w(t.index,e.target.checked)}})}}),n(F,{class:"icon",boxSize:"$6",get color(){return O()},get as(){return V(t.obj)},mr:"$1",get cursor(){return t.obj.type!==C.IMAGE?"inherit":"pointer"},"on:click":e=>{t.obj.type===C.IMAGE&&(e.ctrlKey||e.metaKey||e.shiftKey||p()&&(A.emit("gallery",t.obj.name),e.preventDefault(),e.stopPropagation()))}}),n(u,{class:"name",fontSize:{"@initial":"sm","@md":"md"},css:{position:"relative",whiteSpace:"nowrap",overflow:"hidden",flex:1,minWidth:0,cursor:"pointer"},get title(){return t.obj.name},get children(){return[(()=>{const e=de.cloneNode(!0);return(f=>{f&&G(()=>{const x=()=>{const S=f.parentElement;S&&f.scrollWidth>S.clientWidth?f.classList.add("should-marquee"):f.classList.remove("should-marquee")};x(),window.addEventListener("resize",x),N(()=>{window.removeEventListener("resize",x)})})})(e),e.style.setProperty("display","inline-block"),e.style.setProperty("white-space","nowrap"),e.style.setProperty("padding-right","50px"),_(e,()=>t.obj.name),e})(),(()=>{const e=ue.cloneNode(!0);return _(e,()=>`
                  .should-marquee:hover {
                    animation: marquee 8s linear infinite;
                  }
                  @keyframes marquee {
                    0% { transform: translateX(0); }
                    100% { transform: translateX(calc(-100% + ${a[0].w["@initial"]})); }
                  }
                  `),e})()]}})]}}),n(h,{spacing:"$0_5",justifyContent:"flex-start",overflow:"hidden",w:"8%",display:{"@initial":"none","@md":"flex"},get children(){return n(b,{get when(){var e;return(e=t.obj.label_list)==null?void 0:e.length},get children(){return n($,{get each(){return t.obj.label_list||[]},children:e=>n(R,{get label(){return e.name},placement:"top",get children(){return n(z,{colorScheme:"primary",get bgColor(){return I(e.bg_color)},get color(){return e.bg_color},variant:"solid",mr:"$0_5",textTransform:"none",maxW:"80px",overflow:"hidden",css:{textOverflow:"ellipsis",whiteSpace:"nowrap",fontSize:"0.75rem",paddingInline:"0.5rem",paddingBlock:"0.25rem"},get children(){return e.name}})}})})}})}}),n(X,{w:{"@initial":"90px","@md":"12%"},minW:{"@initial":"90px","@md":"12%"},display:"flex",justifyContent:{"@initial":"flex-end","@md":"flex-start"},flexShrink:0,pr:{"@initial":"0","@md":"$4"},get children(){return n(u,{class:"size",fontSize:{"@initial":"sm","@md":"md"},css:{whiteSpace:"nowrap"},get children(){return T(t.obj.size)}})}}),n(u,{class:"modified",display:{"@initial":"none","@md":"inline"},w:"25%",minW:"25%",textAlign:"right",css:{whiteSpace:"nowrap"},get children(){return J(t.obj.modified)}})]}}),n(b,{get when(){var e;return(e=t.obj.label_list)==null?void 0:e.length},get children(){return n(h,{spacing:"$1",flexWrap:"wrap",pl:"$8",display:{"@initial":"flex","@md":"none"},w:"$full",get children(){return n($,{get each(){return t.obj.label_list||[]},children:e=>n(z,{colorScheme:"primary",get bgColor(){return I(e.bg_color)},get color(){return e.bg_color},variant:"solid",textTransform:"none",css:{fontSize:"0.65rem",paddingInline:"0.3rem",paddingBlock:"0.1rem",whiteSpace:"nowrap",lineHeight:"1.2"},get children(){return e.name}})})}})}})]}})}}),n(ge,{})]},K=t=>{const l=E(),[i,g]=P(),[o,s]=P(!1);ne(()=>{i()&&t.sortCallback(i(),o())});const c=r=>({fontWeight:"bold",fontSize:"$sm",color:"$neutral11",textAlign:r.textAlign,cursor:"pointer",onClick:()=>{r.name===i()?s(!o()):L(()=>{g(r.name),s(!1)})}});return n(h,{class:"title",w:"$full",p:"$2",get children(){return[n(h,{get w(){return a[0].w},spacing:"$1",get children(){return[n(b,{get when(){return m(()=>!t.disableCheckbox,!0)()&&M()},get children(){return n(q,{get checked(){return re()},get indeterminate(){return ie()},onChange:r=>{ae(r.target.checked)}})}}),n(u,y(()=>c(a[0]),{get children(){return l(`home.obj.${a[0].name}`)}}))]}}),n(u,y({get w(){return a[1].w}},()=>c(a[1]),{get children(){return l(`home.obj.${a[1].name}`)}})),n(u,y({get w(){return a[2].w}},()=>c(a[2]),{display:{"@initial":"none","@md":"inline"},get children(){return l(`home.obj.${a[2].name}`)}}))]}})},fe=()=>{const t=o=>{var r;const s=UserPermissions.findIndex(d=>d==="write");if(!UserMethods.can(me(),s,getCurrentPath()))return;const c=Array.from(((r=o.dataTransfer)==null?void 0:r.items)??[]);for(let d=0;d<c.length;d++)if(c[d].kind==="file"){A.emit("tool","upload"),o.preventDefault();break}},{isMouseSupported:l,registerSelectContainer:i,captureContentMenu:g}=D();return i(),n(W,{onDragOver:t,"oncapture:contextmenu":g,class:"list viselect-container",w:"$full",spacing:"$1",get children(){return[n(K,{sortCallback:oe}),n($,{get each(){return se.objs},children:(o,s)=>n(he,{obj:o,get index(){return s()}})})]}})},$e=Object.freeze(Object.defineProperty({__proto__:null,ListTitle:K,default:fe},Symbol.toStringTag,{value:"Module"}));export{K as L,$e as a,a as c};
